'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.plugin = exports.eventType = undefined;

var _logFromKeys = require('../util/logFromKeys');

var _logFromKeys2 = _interopRequireDefault(_logFromKeys);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var type = 'cloudFront';

function eventType() {
  var event = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  var _event$Records = event.Records,
      Records = _event$Records === undefined ? [] : _event$Records;

  return Records[0] && Records[0].cf ? type : false;
}

var keys = ['config.distributionId', 'request.clientIp', 'request.method', 'request.uri', 'request.headers.host[0].value', 'request.headers.["user-agent"][0].value'].map(function (str) {
  return `Records[0].cf.${str}`;
});

function plugin(event, log) {
  (0, _logFromKeys2.default)({
    type,
    event,
    keys,
    log
  });
}

exports.eventType = eventType;
exports.plugin = plugin;